---
import BaseHead from '@/components/BaseHead.astro';
import { ClientRouter } from 'astro:transitions';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import BlogAside from '@/components/BlogAside.astro';
import Comment from '@/components/Comment.astro';
import { comment, config } from '@/consts';

const { frontmatter = { comment: false }, hideAside = false } = Astro.props;
const gridClass = hideAside
  ? 'grid grid-cols-1'
  : 'grid grid-cols-1 lg:grid-cols-4 gap-8';
---

<html lang={config.lang}>
  <head>
    <BaseHead title={Astro.props.title} />
    <ClientRouter />
  </head>

  <body class="bg-skin-secondary relative min-h-screen flex flex-col">
    <Header />
    <main
      class:list={[
        'container',
        'p-4',
        'pb-8',
        'flex-grow',
        'relative',
        'text-skin-base',
        hideAside ? 'pt-32' : 'pt-20',
      ]}
      id="app"
    >
      <div class={gridClass}>
        <!-- Tags and Recent Articles - Shows fourth on mobile (order-4) -->
        {
          !hideAside && (
            <div class="col-span-1 lg:col-span-1 order-3 lg:order-2 mb-6 lg:mb-0 lg:hidden">
              <div>
                <BlogAside />
              </div>
            </div>
          )
        }

        <!-- Desktop Sidebar - Only shows on desktop -->
        {
          !hideAside && (
            <div class="hidden lg:block col-span-1 lg:col-span-1 lg:order-2">
              <div class="lg:sticky lg:top-20">
                <BlogAside />
              </div>
            </div>
          )
        }

        <!-- Main Content - Visible on both mobile and desktop -->
        <div
          class={hideAside
            ? 'col-span-1 order-2 lg:order-1'
            : 'col-span-1 lg:col-span-3 order-2 lg:order-1'}
        >
          <slot />

          {comment?.enable && frontmatter.comment && <Comment />}
        </div>
      </div>
    </main>

    <!-- Footer - Centered at bottom on all screen sizes -->
    <footer class="w-full flex justify-center bg-skin-secondary">
      <Footer />
    </footer>
  </body>
</html>
