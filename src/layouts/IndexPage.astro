---
import BaseHead from '@/components/BaseHead.astro';
import { ClientRouter } from 'astro:transitions';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import Profile from '@/components/Profile.astro';
import BlogAside from '@/components/BlogAside.astro';
import Comment from '@/components/Comment.astro';
import Donate from '@/components/Donate.astro';
import { donate, comment, config } from '@/consts';

const { frontmatter = { comment: false, donate: false }, hideAside = false } =
  Astro.props;
// 保持原有的響應式網格設定
const gridClass = hideAside
  ? 'grid grid-cols-1'
  : 'grid grid-cols-1 lg:grid-cols-4 gap-8';
---

<html lang={config.lang}>
  <head>
    <BaseHead title={Astro.props.title} />
    <ClientRouter />
  </head>

  <body class="bg-skin-secondary relative">
    {!hideAside ? <Header /> : null}
    <main
      class:list={[
        'container',
        'p-4',
        'pb-32',
        'min-h-full',
        'relative',
        'text-skin-base',
        hideAside ? 'pt-4' : 'pt-20',
      ]}
      id="app"
    >
      <div class={gridClass}>
        <!-- Main Content -->
        <div
          class={hideAside
            ? 'col-span-1'
            : 'col-span-1 lg:col-span-3 order-2 lg:order-1'}
        >
          {
            Astro.url.pathname === '/notes/1' && (
              <div class="mb-8 p-4 bg-skin-card rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-2">Notes</h2>
                <p class="text-skin-base">
                  This section is mainly about my notes on different subjects,
                  mainly aviation, but also some notes made while pursuing my
                  Bachelor's degree.
                </p>
              </div>
            )
          }
          {
            Astro.url.pathname === '/thoughts/1' && (
              <div class="mb-8 p-4 bg-skin-card rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-2">My Thoughts</h2>
                <p class="text-skin-base">
                  This section is mainly about my random thoughts, personal
                  opinions, and reflections on different subjects, which might
                  appear to be some more random, less structured thoughts, like
                  quick posts on social media. If you got different thoughts
                  than me, feel free to leave a comment or discuss me via
                  emails.
                </p>
              </div>
            )
          }
          {
            Astro.url.pathname === '/papers/1' && (
              <div class="mb-8 p-4 bg-skin-card rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-2">
                  Research Papers and Articles
                </h2>
                <p class="text-skin-base">
                  This section will mainly documentary my notes from the papers
                  I've read while working on my graduation project.
                </p>
              </div>
            )
          }
          {
            Astro.url.pathname === '/comments/1' && (
              <div class="mb-8 p-4 bg-skin-card rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-2">Comments</h2>
                <p class="text-skin-base">
                  This is the comment section of the entire site. Feel free to
                  share your thoughts, ask questions, or engage in conversations
                  here. If it doesn't appear on the page, wait for 10 seconds.
                </p>
              </div>
            )
          }
          <slot />
          {donate?.enable && frontmatter.donate && <Donate />}
          {comment?.enable && frontmatter.comment && <Comment />}
        </div>

        <!-- Sidebar -->
        {
          !hideAside && (
            <div class="col-span-1 lg:col-span-1 order-1 lg:order-2">
              <div class="sticky top-20">
                <Profile />
                <BlogAside />
              </div>
            </div>
          )
        }
      </div>
    </main>
    <Footer />
  </body><script>
    document.body.querySelectorAll('a').forEach((item) => {
      item.setAttribute('rel', 'nofollow noreferrer');
    });
  </script>
</html>
