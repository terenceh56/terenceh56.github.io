---
import { site } from '@/consts';
import PostView from '@/components/PostView.astro';
import BeyondSurfacePage from '@/layouts/BeyondSurfacePage.astro';
import Pagination from '@/components/Pagination.astro';
import { getCollectionByName } from '@/utils/getCollectionByName';
import { orderBySticky } from '@/utils/orderBySticky';
import getUrl from '@/utils/getUrl';

export async function getStaticPaths({ paginate }) {
  let posts = await getCollectionByName('reflections');
  let sortedPosts = orderBySticky(posts);
  return paginate(sortedPosts, { pageSize: site.postPageSize });
}

const { page } = Astro.props;
---

<BeyondSurfacePage frontmatter={{ comment: false }}>
  <div class="mb-8 p-4 glass rounded-lg shadow-md">
    <h2 class="text-2xl font-bold italic mb-2">Thoughts & Reflections</h2>
    <p class="text-skin-base italic">
      Reflections on what I read, notice, and think â€” fragments of thoughts that
      are still growing.
    </p>
  </div>

  {page.data.map((blog, index) => <PostView blog={blog} />)}
  <Pagination
    currentPage={page.currentPage}
    totalPage={page.lastPage}
    prefixUrl={getUrl('/reflections/')}
  />
</BeyondSurfacePage>
