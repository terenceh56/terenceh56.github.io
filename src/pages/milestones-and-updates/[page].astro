---
import { site } from '@/consts';
import PostView from '@/components/PostView.astro';
import BeyondSurfacePage from '@/layouts/BeyondSurfacePage.astro';
import Pagination from '@/components/Pagination.astro';
import { getCollectionByName } from '@/utils/getCollectionByName';
import { orderBySticky } from '@/utils/orderBySticky';
import getUrl from '@/utils/getUrl';

export async function getStaticPaths({ paginate }) {
  let posts = await getCollectionByName('milestones-and-updates');
  let sortedPosts = orderBySticky(posts);
  return paginate(sortedPosts, { pageSize: site.postPageSize });
}

const { page } = Astro.props;
---

<BeyondSurfacePage frontmatter={{ comment: false }}>
  <div class="mb-8 p-4 glass rounded-lg shadow-md">
    <h2 class="text-2xl font-bold italic mb-2">Milestones & Updates</h2>
    <p class="text-skin-base italic">
      Milestones I've achieved and recent updates randomly.
    </p>
  </div>

  {page.data.map((blog, index) => <PostView blog={blog} />)}
  <Pagination
    currentPage={page.currentPage}
    totalPage={page.lastPage}
    prefixUrl={getUrl('/milestones-and-updates/')}
  />
</BeyondSurfacePage>
