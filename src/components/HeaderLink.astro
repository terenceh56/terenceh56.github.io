---
const {href, icon: iconClass, children, target, ...props} = Astro.props;
import getUrl from "@/utils/getUrl";

const {pathname} = Astro.url;
let hrefMath = href.split('/')
let pathnameMatch = pathname.split('/')
const isActive = hrefMath[1] === pathnameMatch[1]
---
<div class="relative flex items-center w-auto h-10 box">
  <a href={getUrl(href)} target={target} class:list={[isActive ? 'header-link-active' : '', 'header-link']} {...props}>
    <i class={iconClass}/>
    <slot/>
    {
      children.length > 0 && <i class="ri-arrow-down-s-line"></i>
    }
  </a>
  {children && children.length > 0 && (
    <div class="p-4 border rounded cursor-pointer dropdown bg-skin-fill">
      <ul class="space-y-4 w-28">
        {
          children.map(child =>
            <li class="text-center select-none hover:text-skin-active">
              <i class={child.iconClass}></i>
              <a target={child.target ? child.target : "_self"} href={getUrl(child.href)}>{child.name}</a>
            </li>
          )
        }
      </ul>
    </div>
  )}

</div>

<style>
  .dropdown {
    position: absolute;
    top: 100%;
    left: -40%;
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
    transform-origin: top left;
    transition: opacity 160ms ease, visibility 160ms ease, transform 160ms ease;
    transform: translateY(-6px);
  }

  .box:hover .dropdown {
    visibility: visible;
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
  }

</style>

